# content-build / Gatsby prototype / CMS integration POC
1. Clone the following repos in sibling directories:
  * `git clone git@github.com:department-of-veterans-affairs/content-build.git`
  * `git clone git@github.com:department-of-veterans-affairs/va.gov-cms.git`
  * `git clone git@github.com:department-of-veterans-affairs/cms-content-gatsby-poc.git`
1. Set up each repo if needed, per instructions:
  * https://depo-platform-documentation.scrollhelp.site/developer-docs/Setting-up-your-local-frontend-environment.1844215878.html
  * https://vfs.atlassian.net/wiki/spaces/PCMS/pages/1956937732/ddev
  * https://github.com/department-of-veterans-affairs/cms-content-gatsby-poc/blob/main/README.md
1. Check out this branch on content-build:
    ```
    git checkout VACMS-7968-metalsmith-ssg-integration
    ```
1. Check out this branch on cms-content-gatsby-poc:
    ```
    git checkout vacms-7968-metalsmith-test
    ```
1. Ensure the CMS is running, if it is not already:
    ```
    ddev start
    ```
1. Test that Gatsby is generating pages correctly. In cms-content-gatsby-poc:
    ```
    yarn develop # Confirm it builds to completion without error (excepting warnings about NODE_TLS_REJECT_UNAUTHORIZED), and http://local:8000/resources-gatsby/ shows pages.
    ```
    This can take a while on first pass, as Drupal's cache is cold.
1.In content-build, run the build process:
    ```
    yarn build --drupal-address=http://va-gov-cms.ddev.site
    ```
1. When the build process is completed, start the local content-build web server:
    ```
    yarn serve
    ```
1. Visit the site at http://localhost:3002/. You should see a local instance of va.gov.
1. Visit http://localhost:3002/resources-gatsby/. You should see the list of QA pages generated by Gatsby.
1. Click through to these pages. You should see Gatsby pages (identified by logo embedded in output).


